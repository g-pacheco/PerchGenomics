PBS_Window +
xlab("Chromosomes") +
scale_color_manual(values = c("#bdbdbd", "#737373")) +
geom_hline(yintercept = .6368246, linetype = 4, size = .5, colour = "#034e7b") +
geom_hline(yintercept = .8305630, linetype = 4, size = .5, colour = "#990000")
# Saves Manhattan plot ~
ggsave(PBS_WindowUp, file = "PG--GoodSamples_NoRef_NoOutGroup_Groups--PBS_20K.pdf",
device = cairo_pdf, scale = .5, width = 30, height = 16, dpi = 600)
### The BEGINNING ~~~~~
##
# ~ Plots PG--PBS | By George Pacheco.
# Cleans the environment ~
rm(list=ls())
# Sets working directory ~
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# Loads required packages ~
pacman::p_load(qqman, ggman, extrafont)
# Imports extra fonts ~
loadfonts(device = "win", quiet = TRUE)
# Loads datasets ~
PBS <- read.table("PG--GoodSamples_NoRef_NoOutGroup_Groups--PBS_20K.tsv", stringsAsFactors = FALSE, sep = "\t", header = FALSE)
colnames(PBS) <- c("CHR", "SNP", "gPoint", "Window", "NumberOfSites", "Group_A", "Group_B", "Group_C")
# Gets quantiles ~
quantile(PBS$Group_C, c(.9995, .9999))
# Corrects CHR names ~
levels(PBS$CHR <- sub("20909.1", "CHR 01", PBS$CHR))
levels(PBS$CHR <- sub("20910.1", "CHR 02", PBS$CHR))
levels(PBS$CHR <- sub("20911.1", "CHR 03", PBS$CHR))
levels(PBS$CHR <- sub("20912.1", "CHR 04", PBS$CHR))
levels(PBS$CHR <- sub("20913.1", "CHR 05", PBS$CHR))
levels(PBS$CHR <- sub("20914.1", "CHR 06", PBS$CHR))
levels(PBS$CHR <- sub("20915.1", "CHR 07", PBS$CHR))
levels(PBS$CHR <- sub("20916.1", "CHR 08", PBS$CHR))
levels(PBS$CHR <- sub("20917.1", "CHR 09", PBS$CHR))
levels(PBS$CHR <- sub("20918.1", "CHR 10", PBS$CHR))
levels(PBS$CHR <- sub("20919.1", "CHR 11", PBS$CHR))
levels(PBS$CHR <- sub("20920.1", "CHR 12", PBS$CHR))
levels(PBS$CHR <- sub("20921.1", "CHR 13", PBS$CHR))
levels(PBS$CHR <- sub("20922.1", "CHR 14", PBS$CHR))
levels(PBS$CHR <- sub("20923.1", "CHR 15", PBS$CHR))
levels(PBS$CHR <- sub("20924.1", "CHR 16", PBS$CHR))
levels(PBS$CHR <- sub("20925.1", "CHR 17", PBS$CHR))
levels(PBS$CHR <- sub("20926.1", "CHR 18", PBS$CHR))
levels(PBS$CHR <- sub("20927.1", "CHR 19", PBS$CHR))
levels(PBS$CHR <- sub("20928.1", "CHR 20", PBS$CHR))
levels(PBS$CHR <- sub("20929.1", "CHR 21", PBS$CHR))
levels(PBS$CHR <- sub("20930.1", "CHR 22", PBS$CHR))
levels(PBS$CHR <- sub("20931.1", "CHR 23", PBS$CHR))
levels(PBS$CHR <- sub("20932.1", "CHR 24", PBS$CHR))
# Corrects the y-strip facet labels ~
y_strip_labels <- c("20909.1" = "CHR 01", "20910.1" = "CHR 02", "20911.1" = "CHR 03", "20912.1" = "CHR 04", "20913.1" = "CHR 05", "20914.1" = "CHR 06",
"20915.1" = "CHR 07", "20916.1" = "CHR 08", "20917.1" = "CHR 09", "20918.1" = "CHR 10", "20919.1" = "CHR 11", "20920.1" = "CHR 12",
"20921.1" = "CHR 13", "20922.1" = "CHR 14", "20923.1" = "CHR 15", "20924.1" = "CHR 16", "20925.1" = "CHR 17", "20926.1" = "CHR 18",
"20927.1" = "CHR 19", "20928.1" = "CHR 20", "20929.1" = "CHR 21", "20930.1" = "CHR 22", "20931.1" = "CHR 23", "20932.1" = "CHR 24")
# Creates Manhattan panel ~
PBS_Window <-
ggman(PBS, chrom = "CHR", snp = "SNP", bp = "gPoint", pvalue = "Group_C",
logTransform = FALSE, relative.positions = TRUE, sigLine = NA, pointSize = 1.35) +
#scale_x_discrete("Chromosomes",
#                  breaks = c(1, 2, 3),
#                  labels = c("1", "2", "3"),
#                  limits = NULL) +
#                  expand = c(0,0)) +
scale_y_continuous("Population Branch Statistics (Group C)",
breaks = c(.25, .5, .75, 1),
labels = c("0.25", "0.5", "0.75", "1"),
limits = c(0, 1.015),
expand = c(0,0)) +
theme(plot.title = element_blank(),
panel.border = element_blank(),
panel.background = element_rect(fill = "#ffffff"),
panel.grid = element_blank(),
axis.title.x = element_text(size = 18, face = "bold", color = "#000000", margin = margin(t = 20, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size = 18, face = "bold", color = "#000000", margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.text.x = element_text(color = "#000000", size = 10, face = "bold", angle = 45, vjust = 1, hjust = 1),
axis.text.y = element_text(color = "#000000", size = 10),
axis.ticks.x = element_line(size = .3, color = "#000000"),
axis.ticks.y = element_line(size = .3, color = "#000000"),
axis.line = element_line(colour = "#000000", size = .3, color = "#000000"))
# Adds final touches ~
PBS_WindowUp <-
PBS_Window +
xlab("Chromosomes") +
scale_color_manual(values = c("#bdbdbd", "#737373")) +
geom_hline(yintercept = .6368246, linetype = 4, size = .45, colour = "#034e7b") +
geom_hline(yintercept = .8305630, linetype = 4, size = .45, colour = "#990000")
# Saves Manhattan plot ~
ggsave(PBS_WindowUp, file = "PG--GoodSamples_NoRef_NoOutGroup_Groups--PBS_20K.pdf",
device = cairo_pdf, scale = .5, width = 30, height = 16, dpi = 600)
#
##
### The END ~~~~~
### The BEGINNING ~~~~~
##
# ~ Plots PG--PBS | By George Pacheco.
# Cleans the environment ~
rm(list=ls())
# Sets working directory ~
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# Loads required packages ~
pacman::p_load(qqman, ggman, extrafont)
# Imports extra fonts ~
loadfonts(device = "win", quiet = TRUE)
# Loads datasets ~
PBS <- read.table("PG--GoodSamples_NoRef_NoOutGroup_Groups--PBS_50K_25K.tsv", stringsAsFactors = FALSE, sep = "\t", header = FALSE)
colnames(PBS) <- c("CHR", "SNP", "gPoint", "Window", "NumberOfSites", "Group_A", "Group_B", "Group_C")
# Corrects CHR names ~
levels(PBS$CHR <- sub("20909.1", "CHR 01", PBS$CHR))
levels(PBS$CHR <- sub("20910.1", "CHR 02", PBS$CHR))
levels(PBS$CHR <- sub("20911.1", "CHR 03", PBS$CHR))
levels(PBS$CHR <- sub("20912.1", "CHR 04", PBS$CHR))
levels(PBS$CHR <- sub("20913.1", "CHR 05", PBS$CHR))
levels(PBS$CHR <- sub("20914.1", "CHR 06", PBS$CHR))
levels(PBS$CHR <- sub("20915.1", "CHR 07", PBS$CHR))
levels(PBS$CHR <- sub("20916.1", "CHR 08", PBS$CHR))
levels(PBS$CHR <- sub("20917.1", "CHR 09", PBS$CHR))
levels(PBS$CHR <- sub("20918.1", "CHR 10", PBS$CHR))
levels(PBS$CHR <- sub("20919.1", "CHR 11", PBS$CHR))
levels(PBS$CHR <- sub("20920.1", "CHR 12", PBS$CHR))
levels(PBS$CHR <- sub("20921.1", "CHR 13", PBS$CHR))
levels(PBS$CHR <- sub("20922.1", "CHR 14", PBS$CHR))
levels(PBS$CHR <- sub("20923.1", "CHR 15", PBS$CHR))
levels(PBS$CHR <- sub("20924.1", "CHR 16", PBS$CHR))
levels(PBS$CHR <- sub("20925.1", "CHR 17", PBS$CHR))
levels(PBS$CHR <- sub("20926.1", "CHR 18", PBS$CHR))
levels(PBS$CHR <- sub("20927.1", "CHR 19", PBS$CHR))
levels(PBS$CHR <- sub("20928.1", "CHR 20", PBS$CHR))
levels(PBS$CHR <- sub("20929.1", "CHR 21", PBS$CHR))
levels(PBS$CHR <- sub("20930.1", "CHR 22", PBS$CHR))
levels(PBS$CHR <- sub("20931.1", "CHR 23", PBS$CHR))
levels(PBS$CHR <- sub("20932.1", "CHR 24", PBS$CHR))
# Gets quantiles ~
quantile(PBS$Group_C, c(.9995, .9999))
View(PBS)
### The BEGINNING ~~~~~
##
# ~ Plots PG--PBS | By George Pacheco.
# Cleans the environment ~
rm(list=ls())
# Sets working directory ~
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# Loads required packages ~
pacman::p_load(qqman, ggman, extrafont)
# Imports extra fonts ~
loadfonts(device = "win", quiet = TRUE)
# Loads datasets ~
PBS <- read.table("PG--GoodSamples_NoRef_NoOutGroup_Groups--PBS_50K_25K.tsv", stringsAsFactors = FALSE, sep = "\t", header = FALSE)
colnames(PBS) <- c("CHR", "SNP", "gPoint", "Window", "NumberOfSites", "Group_A", "Group_B", "Group_C")
# Corrects CHR names ~
levels(PBS$CHR <- sub("20909.1", "CHR 01", PBS$CHR))
levels(PBS$CHR <- sub("20910.1", "CHR 02", PBS$CHR))
levels(PBS$CHR <- sub("20911.1", "CHR 03", PBS$CHR))
levels(PBS$CHR <- sub("20912.1", "CHR 04", PBS$CHR))
levels(PBS$CHR <- sub("20913.1", "CHR 05", PBS$CHR))
levels(PBS$CHR <- sub("20914.1", "CHR 06", PBS$CHR))
levels(PBS$CHR <- sub("20915.1", "CHR 07", PBS$CHR))
levels(PBS$CHR <- sub("20916.1", "CHR 08", PBS$CHR))
levels(PBS$CHR <- sub("20917.1", "CHR 09", PBS$CHR))
levels(PBS$CHR <- sub("20918.1", "CHR 10", PBS$CHR))
levels(PBS$CHR <- sub("20919.1", "CHR 11", PBS$CHR))
levels(PBS$CHR <- sub("20920.1", "CHR 12", PBS$CHR))
levels(PBS$CHR <- sub("20921.1", "CHR 13", PBS$CHR))
levels(PBS$CHR <- sub("20922.1", "CHR 14", PBS$CHR))
levels(PBS$CHR <- sub("20923.1", "CHR 15", PBS$CHR))
levels(PBS$CHR <- sub("20924.1", "CHR 16", PBS$CHR))
levels(PBS$CHR <- sub("20925.1", "CHR 17", PBS$CHR))
levels(PBS$CHR <- sub("20926.1", "CHR 18", PBS$CHR))
levels(PBS$CHR <- sub("20927.1", "CHR 19", PBS$CHR))
levels(PBS$CHR <- sub("20928.1", "CHR 20", PBS$CHR))
levels(PBS$CHR <- sub("20929.1", "CHR 21", PBS$CHR))
levels(PBS$CHR <- sub("20930.1", "CHR 22", PBS$CHR))
levels(PBS$CHR <- sub("20931.1", "CHR 23", PBS$CHR))
levels(PBS$CHR <- sub("20932.1", "CHR 24", PBS$CHR))
# Gets quantiles ~
quantile(PBS$Group_C, c(.9995, .9999))
# Creates Manhattan panel ~
PBS_Window <-
ggman(PBS, chrom = "CHR", snp = "SNP", bp = "gPoint", pvalue = "Group_C",
logTransform = FALSE, relative.positions = TRUE, sigLine = NA, pointSize = 1.35) +
scale_y_continuous("Population Branch Statistics (Group C)",
breaks = c(.25, .5, .75, 1),
labels = c("0.25", "0.5", "0.75", "1"),
limits = c(0, 1.015),
expand = c(0,0)) +
theme(plot.title = element_blank(),
panel.border = element_blank(),
panel.background = element_rect(fill = "#ffffff"),
panel.grid = element_blank(),
axis.title.x = element_text(size = 18, face = "bold", color = "#000000", margin = margin(t = 20, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size = 18, face = "bold", color = "#000000", margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.text.x = element_text(color = "#000000", size = 10, face = "bold", angle = 45, vjust = 1, hjust = 1),
axis.text.y = element_text(color = "#000000", size = 10),
axis.ticks.x = element_line(size = .3, color = "#000000"),
axis.ticks.y = element_line(size = .3, color = "#000000"),
axis.line = element_line(colour = "#000000", size = .3, color = "#000000"))
# Adds final touches ~
PBS_WindowUp <-
PBS_Window +
xlab("Chromosomes") +
scale_color_manual(values = c("#bdbdbd", "#737373")) +
geom_hline(yintercept = .6535002, linetype = 4, size = .45, colour = "#034e7b") +
geom_hline(yintercept = .8304747, linetype = 4, size = .45, colour = "#990000")
# Saves Manhattan plot ~
ggsave(PBS_WindowUp, file = "PG--GoodSamples_NoRef_NoOutGroup_Groups--PBS_50K_25K.pdf",
device = cairo_pdf, scale = .5, width = 30, height = 16, dpi = 600)
#
##
### The END ~~~~~
# Gets quantiles ~
quantile(PBS$Group_C, c(.9995, .9998))
### The BEGINNING ~~~~~
##
# ~ Plots PG--PBS | By George Pacheco.
# Cleans the environment ~
rm(list=ls())
# Sets working directory ~
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# Loads required packages ~
pacman::p_load(qqman, ggman, extrafont)
# Imports extra fonts ~
loadfonts(device = "win", quiet = TRUE)
# Loads datasets ~
PBS <- read.table("PG--GoodSamples_NoRef_NoOutGroup_Groups--PBS_50K_25K.tsv", stringsAsFactors = FALSE, sep = "\t", header = FALSE)
colnames(PBS) <- c("CHR", "SNP", "gPoint", "Window", "NumberOfSites", "Group_A", "Group_B", "Group_C")
# Corrects CHR names ~
levels(PBS$CHR <- sub("20909.1", "CHR 01", PBS$CHR))
levels(PBS$CHR <- sub("20910.1", "CHR 02", PBS$CHR))
levels(PBS$CHR <- sub("20911.1", "CHR 03", PBS$CHR))
levels(PBS$CHR <- sub("20912.1", "CHR 04", PBS$CHR))
levels(PBS$CHR <- sub("20913.1", "CHR 05", PBS$CHR))
levels(PBS$CHR <- sub("20914.1", "CHR 06", PBS$CHR))
levels(PBS$CHR <- sub("20915.1", "CHR 07", PBS$CHR))
levels(PBS$CHR <- sub("20916.1", "CHR 08", PBS$CHR))
levels(PBS$CHR <- sub("20917.1", "CHR 09", PBS$CHR))
levels(PBS$CHR <- sub("20918.1", "CHR 10", PBS$CHR))
levels(PBS$CHR <- sub("20919.1", "CHR 11", PBS$CHR))
levels(PBS$CHR <- sub("20920.1", "CHR 12", PBS$CHR))
levels(PBS$CHR <- sub("20921.1", "CHR 13", PBS$CHR))
levels(PBS$CHR <- sub("20922.1", "CHR 14", PBS$CHR))
levels(PBS$CHR <- sub("20923.1", "CHR 15", PBS$CHR))
levels(PBS$CHR <- sub("20924.1", "CHR 16", PBS$CHR))
levels(PBS$CHR <- sub("20925.1", "CHR 17", PBS$CHR))
levels(PBS$CHR <- sub("20926.1", "CHR 18", PBS$CHR))
levels(PBS$CHR <- sub("20927.1", "CHR 19", PBS$CHR))
levels(PBS$CHR <- sub("20928.1", "CHR 20", PBS$CHR))
levels(PBS$CHR <- sub("20929.1", "CHR 21", PBS$CHR))
levels(PBS$CHR <- sub("20930.1", "CHR 22", PBS$CHR))
levels(PBS$CHR <- sub("20931.1", "CHR 23", PBS$CHR))
levels(PBS$CHR <- sub("20932.1", "CHR 24", PBS$CHR))
# Gets quantiles ~
quantile(PBS$Group_C, c(.9995, .9998))
# Creates Manhattan panel ~
PBS_Window <-
ggman(PBS, chrom = "CHR", snp = "SNP", bp = "gPoint", pvalue = "Group_C",
logTransform = FALSE, relative.positions = TRUE, sigLine = NA, pointSize = 1.35) +
scale_y_continuous("Population Branch Statistics (Group C)",
breaks = c(.25, .5, .75, 1),
labels = c("0.25", "0.5", "0.75", "1"),
limits = c(0, 1.015),
expand = c(0,0)) +
theme(plot.title = element_blank(),
panel.border = element_blank(),
panel.background = element_rect(fill = "#ffffff"),
panel.grid = element_blank(),
axis.title.x = element_text(size = 18, face = "bold", color = "#000000", margin = margin(t = 20, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size = 18, face = "bold", color = "#000000", margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.text.x = element_text(color = "#000000", size = 10, face = "bold", angle = 45, vjust = 1, hjust = 1),
axis.text.y = element_text(color = "#000000", size = 10),
axis.ticks.x = element_line(size = .3, color = "#000000"),
axis.ticks.y = element_line(size = .3, color = "#000000"),
axis.line = element_line(colour = "#000000", size = .3, color = "#000000"))
# Adds final touches ~
PBS_WindowUp <-
PBS_Window +
xlab("Chromosomes") +
scale_color_manual(values = c("#bdbdbd", "#737373")) +
geom_hline(yintercept = .6535002, linetype = 4, size = .45, colour = "#034e7b") +
geom_hline(yintercept = .8263221, linetype = 4, size = .45, colour = "#990000")
# Saves Manhattan plot ~
ggsave(PBS_WindowUp, file = "PG--GoodSamples_NoRef_NoOutGroup_Groups--PBS_50K_25K.pdf",
device = cairo_pdf, scale = .5, width = 30, height = 16, dpi = 600)
#
##
### The END ~~~~~
# Gets quantiles ~
quantile(PBS$Group_C, c(.9995, .9997))
### The BEGINNING ~~~~~
##
# ~ Plots PG--PBS | By George Pacheco.
# Cleans the environment ~
rm(list=ls())
# Sets working directory ~
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# Loads required packages ~
pacman::p_load(qqman, ggman, extrafont)
# Imports extra fonts ~
loadfonts(device = "win", quiet = TRUE)
# Loads datasets ~
PBS <- read.table("PG--GoodSamples_NoRef_NoOutGroup_Groups--PBS_50K_25K.tsv", stringsAsFactors = FALSE, sep = "\t", header = FALSE)
colnames(PBS) <- c("CHR", "SNP", "gPoint", "Window", "NumberOfSites", "Group_A", "Group_B", "Group_C")
# Corrects CHR names ~
levels(PBS$CHR <- sub("20909.1", "CHR 01", PBS$CHR))
levels(PBS$CHR <- sub("20910.1", "CHR 02", PBS$CHR))
levels(PBS$CHR <- sub("20911.1", "CHR 03", PBS$CHR))
levels(PBS$CHR <- sub("20912.1", "CHR 04", PBS$CHR))
levels(PBS$CHR <- sub("20913.1", "CHR 05", PBS$CHR))
levels(PBS$CHR <- sub("20914.1", "CHR 06", PBS$CHR))
levels(PBS$CHR <- sub("20915.1", "CHR 07", PBS$CHR))
levels(PBS$CHR <- sub("20916.1", "CHR 08", PBS$CHR))
levels(PBS$CHR <- sub("20917.1", "CHR 09", PBS$CHR))
levels(PBS$CHR <- sub("20918.1", "CHR 10", PBS$CHR))
levels(PBS$CHR <- sub("20919.1", "CHR 11", PBS$CHR))
levels(PBS$CHR <- sub("20920.1", "CHR 12", PBS$CHR))
levels(PBS$CHR <- sub("20921.1", "CHR 13", PBS$CHR))
levels(PBS$CHR <- sub("20922.1", "CHR 14", PBS$CHR))
levels(PBS$CHR <- sub("20923.1", "CHR 15", PBS$CHR))
levels(PBS$CHR <- sub("20924.1", "CHR 16", PBS$CHR))
levels(PBS$CHR <- sub("20925.1", "CHR 17", PBS$CHR))
levels(PBS$CHR <- sub("20926.1", "CHR 18", PBS$CHR))
levels(PBS$CHR <- sub("20927.1", "CHR 19", PBS$CHR))
levels(PBS$CHR <- sub("20928.1", "CHR 20", PBS$CHR))
levels(PBS$CHR <- sub("20929.1", "CHR 21", PBS$CHR))
levels(PBS$CHR <- sub("20930.1", "CHR 22", PBS$CHR))
levels(PBS$CHR <- sub("20931.1", "CHR 23", PBS$CHR))
levels(PBS$CHR <- sub("20932.1", "CHR 24", PBS$CHR))
# Gets quantiles ~
quantile(PBS$Group_C, c(.9995, .9997))
# Creates Manhattan panel ~
PBS_Window <-
ggman(PBS, chrom = "CHR", snp = "SNP", bp = "gPoint", pvalue = "Group_C",
logTransform = FALSE, relative.positions = TRUE, sigLine = NA, pointSize = 1.35) +
scale_y_continuous("Population Branch Statistics (Group C)",
breaks = c(.25, .5, .75, 1),
labels = c("0.25", "0.5", "0.75", "1"),
limits = c(0, 1.015),
expand = c(0,0)) +
theme(plot.title = element_blank(),
panel.border = element_blank(),
panel.background = element_rect(fill = "#ffffff"),
panel.grid = element_blank(),
axis.title.x = element_text(size = 18, face = "bold", color = "#000000", margin = margin(t = 20, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size = 18, face = "bold", color = "#000000", margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.text.x = element_text(color = "#000000", size = 10, face = "bold", angle = 45, vjust = 1, hjust = 1),
axis.text.y = element_text(color = "#000000", size = 10),
axis.ticks.x = element_line(size = .3, color = "#000000"),
axis.ticks.y = element_line(size = .3, color = "#000000"),
axis.line = element_line(colour = "#000000", size = .3, color = "#000000"))
# Adds final touches ~
PBS_WindowUp <-
PBS_Window +
xlab("Chromosomes") +
scale_color_manual(values = c("#bdbdbd", "#737373")) +
geom_hline(yintercept = .6535002, linetype = 4, size = .45, colour = "#034e7b") +
geom_hline(yintercept = .7622000, linetype = 4, size = .45, colour = "#990000")
# Saves Manhattan plot ~
ggsave(PBS_WindowUp, file = "PG--GoodSamples_NoRef_NoOutGroup_Groups--PBS_50K_25K.pdf",
device = cairo_pdf, scale = .5, width = 30, height = 16, dpi = 600)
#
##
### The END ~~~~~
### The BEGINNING ~~~~~
##
# ~ Plots PG--PBS | By George Pacheco.
# Cleans the environment ~
rm(list=ls())
# Sets working directory ~
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# Loads required packages ~
pacman::p_load(qqman, ggman, extrafont)
# Imports extra fonts ~
loadfonts(device = "win", quiet = TRUE)
# Loads datasets ~
PBS <- read.table("PG--GoodSamples_NoRef_NoOutGroup_Groups--PBS_50K_25K.tsv", stringsAsFactors = FALSE, sep = "\t", header = FALSE)
colnames(PBS) <- c("CHR", "SNP", "gPoint", "Window", "NumberOfSites", "Group_A", "Group_B", "Group_C")
# Corrects CHR names ~
levels(PBS$CHR <- sub("20909.1", "CHR 01", PBS$CHR))
levels(PBS$CHR <- sub("20910.1", "CHR 02", PBS$CHR))
levels(PBS$CHR <- sub("20911.1", "CHR 03", PBS$CHR))
levels(PBS$CHR <- sub("20912.1", "CHR 04", PBS$CHR))
levels(PBS$CHR <- sub("20913.1", "CHR 05", PBS$CHR))
levels(PBS$CHR <- sub("20914.1", "CHR 06", PBS$CHR))
levels(PBS$CHR <- sub("20915.1", "CHR 07", PBS$CHR))
levels(PBS$CHR <- sub("20916.1", "CHR 08", PBS$CHR))
levels(PBS$CHR <- sub("20917.1", "CHR 09", PBS$CHR))
levels(PBS$CHR <- sub("20918.1", "CHR 10", PBS$CHR))
levels(PBS$CHR <- sub("20919.1", "CHR 11", PBS$CHR))
levels(PBS$CHR <- sub("20920.1", "CHR 12", PBS$CHR))
levels(PBS$CHR <- sub("20921.1", "CHR 13", PBS$CHR))
levels(PBS$CHR <- sub("20922.1", "CHR 14", PBS$CHR))
levels(PBS$CHR <- sub("20923.1", "CHR 15", PBS$CHR))
levels(PBS$CHR <- sub("20924.1", "CHR 16", PBS$CHR))
levels(PBS$CHR <- sub("20925.1", "CHR 17", PBS$CHR))
levels(PBS$CHR <- sub("20926.1", "CHR 18", PBS$CHR))
levels(PBS$CHR <- sub("20927.1", "CHR 19", PBS$CHR))
levels(PBS$CHR <- sub("20928.1", "CHR 20", PBS$CHR))
levels(PBS$CHR <- sub("20929.1", "CHR 21", PBS$CHR))
levels(PBS$CHR <- sub("20930.1", "CHR 22", PBS$CHR))
levels(PBS$CHR <- sub("20931.1", "CHR 23", PBS$CHR))
levels(PBS$CHR <- sub("20932.1", "CHR 24", PBS$CHR))
# Gets quantiles ~
quantile(PBS$Group_C, c(.9995, .9997))
# Creates Manhattan panel ~
PBS_Window <-
ggman(PBS, chrom = "CHR", snp = "SNP", bp = "gPoint", pvalue = "Group_C",
logTransform = FALSE, relative.positions = TRUE, sigLine = NA, pointSize = 1.35) +
scale_y_continuous("Population Branch Statistics (Group C)",
breaks = c(.25, .5, .75, 1),
labels = c("0.25", "0.5", "0.75", "1"),
limits = c(0, 1.015),
expand = c(0,0)) +
theme(plot.title = element_blank(),
panel.border = element_blank(),
panel.background = element_rect(fill = "#ffffff"),
panel.grid = element_blank(),
axis.title.x = element_text(size = 18, face = "bold", color = "#000000", margin = margin(t = 20, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size = 18, face = "bold", color = "#000000", margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.text.x = element_text(color = "#000000", size = 10, face = "bold", angle = 45, vjust = 1, hjust = 1),
axis.text.y = element_text(color = "#000000", size = 10),
axis.ticks.x = element_line(size = .3, color = "#000000"),
axis.ticks.y = element_line(size = .3, color = "#000000"),
axis.line = element_line(colour = "#000000", size = .3, color = "#000000"))
# Adds final touches ~
PBS_WindowUp <-
PBS_Window +
xlab("Chromosomes") +
scale_color_manual(values = c("#bdbdbd", "#737373")) +
geom_hline(yintercept = .6535002, linetype = 4, size = .45, colour = "#034e7b") +
geom_hline(yintercept = .7622000, linetype = 4, size = .45, colour = "#990000")
# Saves Manhattan plot ~
ggsave(PBS_WindowUp, file = "PG--GoodSamples_NoRef_NoOutGroup_Groups--PBS_50K_25K.pdf",
device = cairo_pdf, scale = .5, width = 30, height = 16, dpi = 600)
#
##
### The END ~~~~~
# Gets quantiles ~
quantile(PBS$Group_C, c(.9995, .99975))
# Gets quantiles ~
quantile(PBS$Group_C, c(.9995, .9998))
### The BEGINNING ~~~~~
##
# ~ Plots PG--PBS | By George Pacheco.
# Cleans the environment ~
rm(list=ls())
# Sets working directory ~
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# Loads required packages ~
pacman::p_load(qqman, ggman, extrafont)
# Imports extra fonts ~
loadfonts(device = "win", quiet = TRUE)
# Loads datasets ~
PBS <- read.table("PG--GoodSamples_NoRef_NoOutGroup_Groups--PBS_50K_25K.tsv", stringsAsFactors = FALSE, sep = "\t", header = FALSE)
colnames(PBS) <- c("CHR", "SNP", "gPoint", "Window", "NumberOfSites", "Group_A", "Group_B", "Group_C")
# Corrects CHR names ~
levels(PBS$CHR <- sub("20909.1", "CHR 01", PBS$CHR))
levels(PBS$CHR <- sub("20910.1", "CHR 02", PBS$CHR))
levels(PBS$CHR <- sub("20911.1", "CHR 03", PBS$CHR))
levels(PBS$CHR <- sub("20912.1", "CHR 04", PBS$CHR))
levels(PBS$CHR <- sub("20913.1", "CHR 05", PBS$CHR))
levels(PBS$CHR <- sub("20914.1", "CHR 06", PBS$CHR))
levels(PBS$CHR <- sub("20915.1", "CHR 07", PBS$CHR))
levels(PBS$CHR <- sub("20916.1", "CHR 08", PBS$CHR))
levels(PBS$CHR <- sub("20917.1", "CHR 09", PBS$CHR))
levels(PBS$CHR <- sub("20918.1", "CHR 10", PBS$CHR))
levels(PBS$CHR <- sub("20919.1", "CHR 11", PBS$CHR))
levels(PBS$CHR <- sub("20920.1", "CHR 12", PBS$CHR))
levels(PBS$CHR <- sub("20921.1", "CHR 13", PBS$CHR))
levels(PBS$CHR <- sub("20922.1", "CHR 14", PBS$CHR))
levels(PBS$CHR <- sub("20923.1", "CHR 15", PBS$CHR))
levels(PBS$CHR <- sub("20924.1", "CHR 16", PBS$CHR))
levels(PBS$CHR <- sub("20925.1", "CHR 17", PBS$CHR))
levels(PBS$CHR <- sub("20926.1", "CHR 18", PBS$CHR))
levels(PBS$CHR <- sub("20927.1", "CHR 19", PBS$CHR))
levels(PBS$CHR <- sub("20928.1", "CHR 20", PBS$CHR))
levels(PBS$CHR <- sub("20929.1", "CHR 21", PBS$CHR))
levels(PBS$CHR <- sub("20930.1", "CHR 22", PBS$CHR))
levels(PBS$CHR <- sub("20931.1", "CHR 23", PBS$CHR))
levels(PBS$CHR <- sub("20932.1", "CHR 24", PBS$CHR))
# Gets quantiles ~
quantile(PBS$Group_C, c(.9995, .9998))
# Creates Manhattan panel ~
PBS_Window <-
ggman(PBS, chrom = "CHR", snp = "SNP", bp = "gPoint", pvalue = "Group_C",
logTransform = FALSE, relative.positions = TRUE, sigLine = NA, pointSize = 1.35) +
scale_y_continuous("Population Branch Statistics (Group C)",
breaks = c(.25, .5, .75, 1),
labels = c("0.25", "0.5", "0.75", "1"),
limits = c(0, 1.015),
expand = c(0,0)) +
theme(plot.title = element_blank(),
panel.border = element_blank(),
panel.background = element_rect(fill = "#ffffff"),
panel.grid = element_blank(),
axis.title.x = element_text(size = 18, face = "bold", color = "#000000", margin = margin(t = 20, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size = 18, face = "bold", color = "#000000", margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.text.x = element_text(color = "#000000", size = 10, face = "bold", angle = 45, vjust = 1, hjust = 1),
axis.text.y = element_text(color = "#000000", size = 10),
axis.ticks.x = element_line(size = .3, color = "#000000"),
axis.ticks.y = element_line(size = .3, color = "#000000"),
axis.line = element_line(colour = "#000000", size = .3, color = "#000000"))
# Adds final touches ~
PBS_WindowUp <-
PBS_Window +
xlab("Chromosomes") +
scale_color_manual(values = c("#bdbdbd", "#737373")) +
geom_hline(yintercept = .6535002, linetype = 4, size = .45, colour = "#034e7b") +
geom_hline(yintercept = .8263221, linetype = 4, size = .45, colour = "#990000")
# Saves Manhattan plot ~
ggsave(PBS_WindowUp, file = "PG--GoodSamples_NoRef_NoOutGroup_Groups--PBS_50K_25K.pdf",
device = cairo_pdf, scale = .5, width = 32, height = 16, dpi = 600)
#
##
### The END ~~~~~
